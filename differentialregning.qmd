---
title: "Differentialregning"
autor: "Lasse Hjorth Madsen"
published: "today"
format: html
---

## Hvad er differentialregning?

Differentialregning handler om at forstå, hvordan ting ændrer sig -- som for eksemple som hvor hurtigt en cykel kører, eller hvordan dens hastighed ændrer sig. Vi bruger eksempler og grafer til at gøre det nemt at forstå.

Lad os komme i gang.

```{r setup}
library(tidyverse)
library(ggrepel)
theme_set(theme_minimal())
```

## 1. En simpel funktion

Forestil dig, at du cykler, og vi måler, hvor langt du kommer som funktion af tid. Lad os sige, at afstanden (i meter) følger denne enkle regel:

$$s(t) = t^2$$

Her er $t$ tiden (i sekunder), og $s(t)$ er afstanden. Hvis du cykler i 3 sekunder, har du kørt $3^2 = 9$ meter.

Lad os tegne en graf for at se, hvordan det ser ud:

```{r plot-funktion}
tid = seq(0, 5, by = 0.1)
afstand = tid^2

data <- tibble(tid, afstand)

# Plot funktionen
p1 <- ggplot(data, aes(x = tid, y = afstand)) +
  geom_line(color = "blue", size = 1, alpha = 0.5) +
  labs(title = "Afstand tilbagelagt på cyklen",
       x = "Tid (sekunder)",
       y = "Afstand (meter)")

p1
```

Denne graf viser, at jo længere tid du cykler, jo hurtigere stiger afstanden -- det er fordi, du kører hurtigere og hurtigere!

## 2. Hvad er en tangent?

En **tangent** er en lige linje, der rører grafen et bestemt sted og viser, hvor stejl grafen er lige der. For vores cykel betyder tangentens **hældning** din **hastighed** på det tidspunkt.

Tænk på det sådan: Hvis du kører op ad en bakke, er bakken stejl, hvis du kører hurtigt. Tangenten hjælper os med at måle præcis, hvor hurtigt du kører på et givet tidspunkt.

Lad os tegne en tangent til grafen, når $t = 2$ sekunder:

```{r plot-tangent}
# Funktion for afstand
s  <- function(t) t^2
sm <- function(t, t0) 2 * t0 * (t - t0) + s(t0) 

# Data til tangent
tangent_data <- expand_grid(data, punkt = seq(1, 3)) |> 
  mutate(y = sm(tid, punkt))

# Plot funktion og tangent
p1 +
  geom_line(data = filter(tangent_data, punkt == 1), aes(x = tid, y = y), color = "red", size = 0.1, linetype = "dashed") +
  labs(title = "Afstand med tangent ved t = 2 sekunder") 
```

Den røde streg er tangenten ved $t=2$. Hældningen af denne linje fortæller os hastigheden, som vi snart finder ud af!

## 3. Hvordan finder vi tangentens hældning?

For at finde hastigheden (tangentens hældning), bruger vi **differentiering**. Det betyder, at vi finder en ny regel, der fortæller os, hvor stejl grafen er for hver tid $t$.

Vores afstandsfunktion er:

$$ s(t) = t^2 $$

Når vi differentierer, får vi den **afledte** funktion, som er hastigheden. Vi kalder den $s'(t)$, som udtales "s-mærke".

$$ s'(t) = 2t $$

Det betyder, at hastigheden ved $t = 2$ sekunder er:

$$ s'(2) = 2 \cdot 2 = 4 \text{ meter per sekund} $$

Så ved $t=2$ kører du 4 meter per sekund. Den afledte funktion $s'(t)=2t$ giver os hastigheden for enhver tid.

## 4. Flere tangenter og deres hældninger

Lad os tegne grafen igen, men nu med tangenter ved flere tidspunkter, så vi kan se, hvordan hastigheden ændrer sig. Vi vælger $t=1,2,3$:

```{r flere-tangenter}
slopes <- tangent_data |> 
  distinct(punkt) |> 
  mutate(afstand = s(punkt),
         slope = paste("Hældning:", 2 * punkt))

p1 + 
  geom_line(data = tangent_data, 
            aes(x = tid, y = y, color = factor(punkt), group = punkt),
            size = 0.5, linetype = "dashed") +
  geom_text_repel(data = slopes, 
                  aes(x = punkt, y = afstand, label = slope),
                  force = 100,
                  linesize = 0.5,
                  direction = "y",
                  segment.color = "grey",
                  arrow = arrow(length = unit(0.02, "npc"))) +
  labs(title = "Afstand med tangenter ved t = 1, 2, 3",
       color = "Tidspunkt")
```

Hver tangent viser hastigheden ved et bestemt tidspunkt. Bemærk, at hældningerne bliver større, når tiden stiger -- det betyder, at cyklen kører hurtigere og hurtigere.

## 5. Den afledte funktion: Hastighedsgrafen

Den afledte funktion $s'(t) = 2t$ er faktisk en graf over hastigheden. Lad os tegne den for at se, hvordan hastigheden ændrer sig over tid:

```{r plot-afledte}
# Plot hastighed
ggplot(data, aes(x = tid, y = 2*tid)) +
  geom_line(color = "darkgreen", size = 1) +
  labs(title = "Hastighed som funktion af tid",
       x = "Tid (sekunder)",
       y = "Hastighed (meter/sekund)") 
```

Denne graf viser, at hastigheden stiger jævnt. Hvis vi kigger tilbage på tangenterne, kan vi se, at hældningerne (hastighederne) passer med værdierne på denne graf. For eksempel ved $t = 2$ er hastigheden 4, præcis som vi beregnede!

## 6. Den dobbelte afledte: Acceleration

Nu tager vi det et skridt videre. Hastigheden ændrer sig også -- det kalder vi **acceleration**. For at finde accelerationen, differentierer vi hastighedsfunktionen (den afledte) én gang til. Det kaldes den **dobbelt afledte**.

Hastighedsfunktionen er:

$$s'(t) = 2t$$

Når vi differentierer igen, får vi:

$$s''(t) = 2$$

Dette betyder, at accelerationen er 2 meter per sekund per sekund (eller $2 \text{m/s}^2$). Det er konstant, så cyklen øger sin hastighed med 2 meter per sekund for hvert sekund.

## 7. Illustration af acceleration

Lad os tegne en graf for accelerationen for at gøre det tydeligt:

```{r plot-acceleration}
# Plot acceleration
ggplot(data, aes(x = tid, y = 2)) +
  geom_line(color = "orange", size = 1) +
  labs(title = "Acceleration som funktion af tid",
       x = "Tid (sekunder)",
       y = "Acceleration (m/s²)") +
  theme_minimal()
```

Denne graf er en lige linje, fordi accelerationen er konstant. Det fortæller os, at cyklen hele tiden får mere fart med samme styrke.

## Opsummering

-   Vi startede med at kigge på, hvor langt en cykel kører $s(t) = t^2$.
-   Vi fandt ud af, at tangentens hældning viser **hastigheden**, og vi brugte differentiering til at finde hastighedsfunktionen $s'(t) = 2t$.
-   Vi tegnede tangenter og så, at hastigheden stiger over tid.
-   Til sidst lærte vi om **acceleration** ved at differentiere igen $s''(t) = 2$, og vi tegnede en graf for at vise, at accelerationen er konstant.
